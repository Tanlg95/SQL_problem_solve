Create table If Not Exists Transactions (transaction_id int, customer_id int, transaction_date date, amount int);
Truncate table Transactions;
insert into Transactions (transaction_id, customer_id, transaction_date, amount) values ('1', '101', '2023-05-01', '100');
insert into Transactions (transaction_id, customer_id, transaction_date, amount) values ('2', '101', '2023-05-02', '150');
insert into Transactions (transaction_id, customer_id, transaction_date, amount) values ('3', '101', '2023-05-03', '200');
insert into Transactions (transaction_id, customer_id, transaction_date, amount) values ('4', '102', '2023-05-01', '50');
insert into Transactions (transaction_id, customer_id, transaction_date, amount) values ('5', '102', '2023-05-03', '100');
insert into Transactions (transaction_id, customer_id, transaction_date, amount) values ('6', '102', '2023-05-04', '200');
insert into Transactions (transaction_id, customer_id, transaction_date, amount) values ('7', '105', '2023-05-01', '100');
insert into Transactions (transaction_id, customer_id, transaction_date, amount) values ('8', '105', '2023-05-02', '150');
insert into Transactions (transaction_id, customer_id, transaction_date, amount) values ('9', '105', '2023-05-03', '200');
insert into Transactions (transaction_id, customer_id, transaction_date, amount) values ('10', '105', '2023-05-04', '300');
insert into Transactions (transaction_id, customer_id, transaction_date, amount) values ('11', '105', '2023-05-12', '250');
insert into Transactions (transaction_id, customer_id, transaction_date, amount) values ('12', '105', '2023-05-13', '260');
insert into Transactions (transaction_id, customer_id, transaction_date, amount) values ('13', '105', '2023-05-14', '270');

-- output:

| customer_id | consecutive_start | consecutive_end |
| ----------- | ----------------- | --------------- |
| 101         | 2023-05-01        | 2023-05-03      |
| 105         | 2023-05-01        | 2023-05-04      |
| 105         | 2023-05-12        | 2023-05-14      |

-- test case 2 --- begin

| transaction_id | customer_id | transaction_date | amount |
| -------------- | ----------- | ---------------- | ------ |
| 878            | 12          | 2019-8-26        | 1254   |
| 954            | 25          | 2019-8-29        | 3159   |
| 3              | 35          | 2019-8-6         | 4299   |
| 387            | 43          | 2019-7-4         | 3353   |
| 855            | 42          | 2019-8-1         | 4435   |
| 322            | 42          | 2019-8-18        | 5886   |
| 358            | 44          | 2019-7-4         | 1053   |
| 904            | 37          | 2019-7-19        | 410    |
| 69             | 14          | 2019-8-5         | 1143   |
| 834            | 33          | 2019-8-20        | 6572   |
| 914            | 35          | 2019-8-17        | 2673   |
| 631            | 22          | 2019-7-19        | 6558   |
| 324            | 46          | 2019-8-14        | 7608   |
| 395            | 2           | 2019-7-10        | 7322   |
| 849            | 44          | 2019-7-21        | 7541   |
| 249            | 14          | 2019-7-30        | 7457   |
| 515            | 42          | 2019-7-4         | 5185   |
| 101            | 19          | 2019-8-31        | 2577   |
| 70             | 14          | 2019-7-21        | 1707   |
| 501            | 15          | 2019-7-8         | 4552   |
| 902            | 49          | 2019-7-28        | 7977   |
| 747            | 46          | 2019-7-19        | 348    |
| 184            | 50          | 2019-8-15        | 9829   |
| 485            | 37          | 2019-8-3         | 5871   |
| 146            | 18          | 2019-7-22        | 4236   |
| 67             | 49          | 2019-8-20        | 3127   |
| 451            | 44          | 2019-8-2         | 4914   |
| 102            | 50          | 2019-7-27        | 8907   |
| 104            | 24          | 2019-8-22        | 1829   |
| 350            | 32          | 2019-7-8         | 471    |
| 381            | 5           | 2019-7-3         | 2438   |
| 453            | 43          | 2019-8-19        | 9495   |
| 692            | 30          | 2019-8-29        | 3078   |
| 806            | 15          | 2019-8-18        | 227    |
| 662            | 5           | 2019-7-2         | 698    |
| 575            | 11          | 2019-8-3         | 1789   |
| 603            | 2           | 2019-7-18        | 299    |
| 542            | 33          | 2019-8-3         | 2986   |
| 154            | 11          | 2019-8-24        | 5523   |
| 46             | 46          | 2019-8-10        | 7613   |
| 124            | 37          | 2019-8-4         | 7689   |
| 380            | 34          | 2019-7-28        | 7943   |
| 57             | 43          | 2019-8-15        | 8253   |
| 417            | 44          | 2019-8-21        | 4286   |
| 272            | 19          | 2019-8-25        | 9797   |
| 50             | 43          | 2019-8-11        | 5901   |
| 483            | 22          | 2019-8-25        | 3163   |
| 870            | 24          | 2019-8-12        | 6496   |
| 758            | 11          | 2019-8-27        | 5245   |
| 442            | 1           | 2019-7-25        | 2945   |
| 661            | 14          | 2019-8-31        | 2114   |
| 327            | 23          | 2019-8-15        | 8874   |
| 920            | 2           | 2019-8-4         | 2418   |
| 416            | 46          | 2019-8-30        | 8014   |
| 182            | 20          | 2019-7-27        | 8056   |
| 141            | 19          | 2019-7-28        | 5984   |
| 963            | 49          | 2019-8-16        | 2685   |
| 507            | 43          | 2019-7-21        | 1201   |
| 513            | 20          | 2019-7-23        | 8755   |
| 407            | 5           | 2019-8-27        | 7249   |
| 625            | 50          | 2019-8-27        | 8628   |
| 339            | 35          | 2019-7-28        | 9929   |
| 805            | 5           | 2019-7-7         | 8879   |
| 363            | 32          | 2019-8-23        | 8814   |
| 952            | 50          | 2019-7-11        | 5291   |
| 208            | 22          | 2019-7-28        | 1945   |
| 609            | 24          | 2019-7-17        | 9970   |
| 81             | 50          | 2019-7-14        | 5976   |
| 660            | 45          | 2019-7-30        | 6332   |
| 562            | 6           | 2019-7-28        | 4985   |
| 153            | 14          | 2019-7-23        | 4223   |
| 627            | 6           | 2019-7-26        | 2651   |
| 396            | 19          | 2019-8-7         | 8791   |
| 177            | 4           | 2019-7-9         | 4111   |
| 254            | 34          | 2019-7-8         | 7943   |
| 867            | 1           | 2019-8-3         | 2516   |
| 359            | 37          | 2019-7-27        | 428    |
| 98             | 43          | 2019-8-26        | 9826   |
| 240            | 42          | 2019-8-19        | 9831   |
| 20             | 32          | 2019-8-4         | 8316   |
| 866            | 5           | 2019-8-26        | 7966   |
| 24             | 46          | 2019-8-9         | 1211   |
| 953            | 30          | 2019-7-8         | 2114   |
| 941            | 45          | 2019-7-23        | 5929   |
| 532            | 38          | 2019-8-5         | 9138   |
| 342            | 30          | 2019-8-16        | 4328   |
| 771            | 4           | 2019-7-19        | 2915   |
| 790            | 24          | 2019-7-13        | 9362   |
| 99             | 24          | 2019-8-8         | 5284   |
| 801            | 49          | 2019-7-8         | 4787   |
| 697            | 15          | 2019-8-7         | 7399   |
| 284            | 30          | 2019-7-25        | 755    |
| 283            | 38          | 2019-8-7         | 6098   |
| 832            | 28          | 2019-7-15        | 5934   |
| 365            | 50          | 2019-8-8         | 4054   |
| 25             | 10          | 2019-7-19        | 5291   |
| 778            | 10          | 2019-8-8         | 4294   |
| 719            | 45          | 2019-8-8         | 9396   |
| 716            | 24          | 2019-8-27        | 4653   |
| 808            | 34          | 2019-7-17        | 2706   |
| 636            | 4           | 2019-7-20        | 527    |
| 17             | 12          | 2019-7-13        | 6026   |
| 227            | 6           | 2019-8-11        | 2265   |
| 529            | 45          | 2019-7-18        | 5428   |
| 955            | 12          | 2019-8-24        | 9890   |
| 123            | 24          | 2019-7-27        | 9271   |
| 334            | 44          | 2019-8-1         | 3199   |
| 754            | 20          | 2019-7-11        | 7033   |
| 596            | 20          | 2019-7-31        | 7558   |
| 62             | 30          | 2019-7-10        | 5714   |
| 738            | 22          | 2019-7-23        | 7237   |
| 165            | 38          | 2019-7-22        | 1932   |
| 670            | 28          | 2019-8-1         | 5117   |
| 836            | 25          | 2019-8-18        | 995    |
| 426            | 6           | 2019-8-15        | 3823   |
| 621            | 50          | 2019-7-19        | 1421   |
| 582            | 5           | 2019-7-10        | 489    |
| 880            | 35          | 2019-8-19        | 8930   |
| 654            | 1           | 2019-7-5         | 597    |
| 525            | 5           | 2019-7-9         | 9372   |
| 780            | 24          | 2019-8-25        | 7738   |
| 486            | 43          | 2019-8-6         | 8361   |
| 412            | 45          | 2019-7-10        | 1743   |
| 434            | 23          | 2019-8-2         | 5721   |
| 825            | 44          | 2019-8-8         | 1016   |
| 556            | 33          | 2019-8-19        | 2267   |
| 989            | 18          | 2019-8-27        | 4736   |
| 967            | 12          | 2019-8-29        | 4141   |
| 136            | 10          | 2019-7-21        | 9152   |
| 368            | 34          | 2019-8-15        | 5164   |
| 137            | 2           | 2019-7-20        | 1542   |
| 642            | 35          | 2019-8-15        | 6907   |
| 962            | 12          | 2019-8-8         | 3431   |
| 979            | 5           | 2019-8-1         | 1934   |
| 657            | 35          | 2019-8-16        | 5619   |
| 700            | 6           | 2019-8-18        | 6014   |
| 268            | 38          | 2019-8-28        | 3664   |
| 437            | 42          | 2019-8-13        | 9419   |
| 546            | 1           | 2019-7-16        | 6105   |
| 196            | 24          | 2019-7-6         | 745    |
| 516            | 43          | 2019-7-3         | 1577   |
| 480            | 37          | 2019-8-17        | 5613   |
| 445            | 49          | 2019-8-18        | 5526   |
| 317            | 15          | 2019-7-19        | 7639   |
| 959            | 32          | 2019-7-30        | 1525   |
| 167            | 23          | 2019-7-8         | 6396   |
| 202            | 14          | 2019-7-3         | 5907   |
| 557            | 14          | 2019-8-14        | 4257   |
| 49             | 33          | 2019-7-16        | 216    |
| 373            | 11          | 2019-7-25        | 2436   |
| 712            | 28          | 2019-8-17        | 4680   |
| 768            | 5           | 2019-7-24        | 523    |
| 728            | 35          | 2019-7-21        | 9578   |
| 934            | 15          | 2019-7-26        | 4782   |
| 581            | 1           | 2019-7-28        | 9641   |
| 406            | 35          | 2019-8-20        | 2913   |
| 14             | 45          | 2019-7-20        | 197    |
| 695            | 25          | 2019-8-24        | 2470   |
| 877            | 26          | 2019-8-30        | 5809   |
| 207            | 37          | 2019-7-5         | 9647   |
| 531            | 5           | 2019-7-21        | 6007   |
| 489            | 46          | 2019-8-4         | 7544   |
| 430            | 2           | 2019-7-15        | 800    |
| 447            | 43          | 2019-8-23        | 6949   |
| 586            | 25          | 2019-7-20        | 6983   |
| 377            | 1           | 2019-8-2         | 9456   |
| 96             | 35          | 2019-7-12        | 6196   |
| 937            | 20          | 2019-7-4         | 1852   |
| 777            | 4           | 2019-7-25        | 5718   |
| 41             | 5           | 2019-7-13        | 9451   |
| 536            | 33          | 2019-8-1         | 2508   |
| 304            | 10          | 2019-7-15        | 7756   |
| 223            | 26          | 2019-8-21        | 6032   |
| 903            | 20          | 2019-8-22        | 3629   |
| 534            | 35          | 2019-7-13        | 1588   |
| 725            | 19          | 2019-7-1         | 8011   |
| 685            | 43          | 2019-8-13        | 803    |
| 750            | 30          | 2019-7-15        | 8184   |
| 605            | 26          | 2019-8-3         | 8434   |
| 760            | 4           | 2019-8-5         | 6985   |
| 468            | 35          | 2019-7-5         | 2269   |
| 374            | 12          | 2019-8-18        | 4565   |
| 36             | 35          | 2019-8-8         | 3711   |
| 656            | 15          | 2019-7-10        | 9605   |
| 53             | 30          | 2019-7-12        | 7174   |
| 564            | 22          | 2019-8-12        | 5285   |
| 549            | 46          | 2019-7-31        | 4780   |
| 232            | 32          | 2019-7-15        | 6708   |
| 835            | 4           | 2019-8-20        | 6775   |
| 570            | 42          | 2019-7-11        | 6465   |
| 28             | 15          | 2019-7-27        | 2139   |
| 538            | 12          | 2019-7-6         | 4936   |
| 493            | 35          | 2019-7-29        | 3014   |
| 294            | 46          | 2019-7-20        | 4374   |
| 822            | 5           | 2019-8-24        | 9633   |
| 229            | 26          | 2019-8-29        | 2389   |
| 106            | 19          | 2019-7-18        | 723    |
| 446            | 4           | 2019-7-16        | 8835   |
| 524            | 49          | 2019-7-31        | 3776   |
| 97             | 4           | 2019-7-4         | 4540   |
| 776            | 12          | 2019-8-21        | 8014   |
| 393            | 5           | 2019-8-14        | 9666   |
| 544            | 6           | 2019-8-28        | 7325   |
| 162            | 30          | 2019-7-14        | 5753   |
| 127            | 32          | 2019-7-1         | 4267   |
| 178            | 12          | 2019-8-16        | 9267   |
| 584            | 14          | 2019-8-11        | 5384   |
| 357            | 4           | 2019-8-27        | 1452   |
| 650            | 14          | 2019-8-17        | 4503   |
| 690            | 30          | 2019-7-26        | 3057   |
| 541            | 33          | 2019-7-10        | 6495   |
| 89             | 33          | 2019-8-26        | 5578   |
| 810            | 25          | 2019-7-19        | 9614   |
| 616            | 6           | 2019-8-20        | 1664   |
| 225            | 6           | 2019-8-10        | 3877   |
| 896            | 32          | 2019-8-29        | 8794   |
| 315            | 22          | 2019-7-21        | 646    |
| 469            | 4           | 2019-7-11        | 4431   |
| 476            | 6           | 2019-7-12        | 4913   |
| 948            | 18          | 2019-7-19        | 5017   |
| 921            | 50          | 2019-8-21        | 5524   |
| 126            | 28          | 2019-7-31        | 5158   |
| 29             | 50          | 2019-8-17        | 4272   |
| 370            | 20          | 2019-7-10        | 5614   |
| 548            | 15          | 2019-8-19        | 5732   |
| 991            | 37          | 2019-8-5         | 8808   |
| 986            | 23          | 2019-7-28        | 5976   |
| 608            | 43          | 2019-8-24        | 5300   |
| 367            | 10          | 2019-7-1         | 6237   |
| 911            | 4           | 2019-7-7         | 716    |
| 314            | 11          | 2019-7-20        | 6930   |
| 128            | 1           | 2019-7-2         | 4434   |
| 741            | 25          | 2019-8-21        | 9436   |
| 856            | 14          | 2019-8-19        | 8068   |
| 807            | 42          | 2019-7-26        | 5158   |
| 118            | 12          | 2019-8-27        | 8360   |
| 353            | 1           | 2019-7-10        | 7194   |
| 514            | 2           | 2019-7-3         | 4570   |
| 117            | 35          | 2019-7-4         | 6399   |
| 341            | 22          | 2019-7-11        | 2229   |
| 310            | 46          | 2019-8-11        | 1772   |
| 845            | 25          | 2019-8-5         | 5843   |
| 439            | 1           | 2019-7-13        | 6034   |
| 454            | 46          | 2019-8-24        | 5331   |
| 161            | 25          | 2019-7-9         | 8035   |
| 326            | 38          | 2019-7-23        | 8595   |
| 943            | 14          | 2019-7-15        | 2654   |
| 403            | 42          | 2019-7-9         | 7680   |
| 390            | 38          | 2019-7-10        | 7127   |
| 655            | 25          | 2019-8-10        | 5188   |
| 16             | 33          | 2019-8-15        | 7127   |
| 457            | 24          | 2019-7-21        | 6504   |
| 972            | 6           | 2019-8-17        | 6954   |
| 460            | 32          | 2019-7-13        | 6856   |
| 813            | 25          | 2019-8-11        | 8009   |
| 860            | 35          | 2019-7-6         | 9930   |
| 30             | 43          | 2019-7-23        | 1736   |
| 256            | 15          | 2019-8-6         | 9441   |
| 629            | 24          | 2019-7-11        | 2731   |
| 261            | 43          | 2019-8-14        | 3062   |
| 452            | 15          | 2019-7-25        | 3855   |
| 872            | 24          | 2019-7-16        | 8707   |
| 74             | 5           | 2019-8-30        | 2813   |
| 244            | 26          | 2019-8-27        | 1226   |
| 984            | 11          | 2019-7-9         | 2205   |
| 576            | 44          | 2019-8-17        | 8028   |
| 114            | 46          | 2019-7-6         | 2108   |
| 427            | 37          | 2019-7-18        | 4050   |
| 418            | 42          | 2019-8-22        | 8516   |
| 23             | 44          | 2019-7-24        | 9342   |
| 770            | 25          | 2019-8-2         | 4469   |
| 968            | 38          | 2019-7-1         | 4948   |
| 37             | 6           | 2019-8-29        | 4589   |
| 263            | 5           | 2019-8-28        | 6538   |
| 890            | 46          | 2019-8-21        | 8816   |
| 676            | 50          | 2019-8-5         | 6127   |
| 409            | 24          | 2019-7-15        | 8412   |
| 318            | 12          | 2019-8-4         | 4290   |
| 176            | 22          | 2019-7-4         | 2662   |
| 615            | 49          | 2019-8-27        | 4457   |
| 812            | 11          | 2019-7-22        | 8474   |
| 898            | 6           | 2019-8-26        | 5642   |
| 693            | 44          | 2019-7-5         | 391    |
| 999            | 44          | 2019-7-19        | 9523   |
| 135            | 43          | 2019-7-5         | 5578   |
| 171            | 22          | 2019-7-10        | 5639   |
| 950            | 45          | 2019-8-18        | 7520   |
| 997            | 35          | 2019-7-3         | 9903   |
| 519            | 28          | 2019-7-18        | 3585   |
| 789            | 5           | 2019-8-16        | 2992   |
| 271            | 6           | 2019-8-14        | 8792   |
| 144            | 43          | 2019-7-6         | 4115   |
| 606            | 14          | 2019-7-7         | 7050   |
| 668            | 44          | 2019-8-23        | 5459   |
| 726            | 35          | 2019-7-2         | 8526   |
| 983            | 38          | 2019-7-15        | 8548   |
| 925            | 22          | 2019-8-17        | 5743   |
| 710            | 6           | 2019-8-16        | 1250   |
| 280            | 24          | 2019-7-8         | 5674   |
| 940            | 32          | 2019-7-21        | 6719   |
| 204            | 34          | 2019-7-2         | 4089   |
| 672            | 6           | 2019-7-15        | 4641   |
| 394            | 30          | 2019-8-10        | 5182   |
| 869            | 26          | 2019-8-22        | 2078   |
| 82             | 28          | 2019-8-3         | 3150   |
| 595            | 46          | 2019-7-17        | 3908   |
| 375            | 15          | 2019-7-24        | 1840   |
| 933            | 6           | 2019-7-25        | 2535   |
| 376            | 32          | 2019-7-9         | 9384   |
| 773            | 6           | 2019-8-5         | 9020   |
| 980            | 19          | 2019-7-22        | 4444   |
| 158            | 5           | 2019-8-15        | 3187   |
| 260            | 19          | 2019-7-31        | 2999   |
| 264            | 43          | 2019-7-8         | 8793   |
| 392            | 10          | 2019-7-17        | 4376   |
| 949            | 38          | 2019-7-16        | 6229   |
| 723            | 33          | 2019-7-23        | 2580   |
| 371            | 49          | 2019-8-22        | 8107   |
| 521            | 11          | 2019-7-16        | 8589   |
| 996            | 25          | 2019-7-4         | 8117   |
| 361            | 18          | 2019-8-23        | 3867   |
| 398            | 30          | 2019-7-7         | 3775   |
| 73             | 46          | 2019-8-18        | 4963   |
| 785            | 1           | 2019-7-26        | 2186   |
| 854            | 11          | 2019-8-21        | 1595   |
| 444            | 35          | 2019-8-7         | 9758   |
| 243            | 38          | 2019-7-21        | 5349   |
| 844            | 24          | 2019-8-13        | 275    |
| 236            | 20          | 2019-8-31        | 8463   |
| 300            | 22          | 2019-8-23        | 7310   |
| 533            | 4           | 2019-8-18        | 4679   |
| 731            | 22          | 2019-7-13        | 4395   |
| 440            | 43          | 2019-8-30        | 5226   |
| 899            | 24          | 2019-8-7         | 2505   |
| 312            | 18          | 2019-8-25        | 8646   |
| 764            | 44          | 2019-7-14        | 2629   |
| 572            | 38          | 2019-8-13        | 2006   |
| 978            | 14          | 2019-8-29        | 3421   |
| 579            | 43          | 2019-8-20        | 8528   |
| 455            | 12          | 2019-8-17        | 6276   |
| 478            | 34          | 2019-8-27        | 4663   |
| 794            | 14          | 2019-8-9         | 2314   |
| 600            | 14          | 2019-7-10        | 3889   |
| 255            | 6           | 2019-7-22        | 222    |
| 43             | 37          | 2019-8-21        | 2867   |
| 194            | 14          | 2019-7-25        | 1656   |
| 170            | 33          | 2019-8-28        | 2055   |
| 273            | 19          | 2019-8-15        | 7341   |
| 929            | 35          | 2019-8-24        | 5547   |
| 179            | 44          | 2019-8-12        | 9102   |
| 475            | 33          | 2019-8-30        | 8190   |
| 287            | 30          | 2019-7-4         | 2348   |
| 998            | 10          | 2019-7-22        | 9075   |
| 379            | 46          | 2019-7-4         | 1487   |
| 736            | 26          | 2019-7-19        | 5104   |
| 580            | 35          | 2019-8-22        | 1827   |
| 66             | 42          | 2019-7-10        | 5723   |
| 775            | 34          | 2019-7-9         | 2549   |
| 253            | 18          | 2019-7-12        | 6396   |
| 602            | 14          | 2019-8-13        | 1449   |
| 458            | 49          | 2019-8-15        | 9621   |
| 301            | 22          | 2019-7-2         | 3269   |
| 974            | 30          | 2019-7-2         | 1206   |
| 482            | 33          | 2019-7-4         | 2445   |
| 173            | 44          | 2019-8-10        | 2036   |
| 364            | 44          | 2019-7-17        | 4427   |
| 674            | 32          | 2019-7-11        | 9814   |
| 200            | 18          | 2019-7-24        | 2061   |
| 471            | 26          | 2019-7-25        | 147    |
| 378            | 26          | 2019-8-6         | 9452   |
| 873            | 28          | 2019-7-19        | 5474   |
| 494            | 20          | 2019-7-26        | 9179   |
| 512            | 4           | 2019-8-31        | 8983   |
| 27             | 19          | 2019-7-20        | 8498   |
| 150            | 38          | 2019-7-26        | 3575   |
| 522            | 49          | 2019-7-30        | 184    |
| 205            | 25          | 2019-7-24        | 492    |
| 42             | 50          | 2019-8-7         | 1290   |
| 1000           | 32          | 2019-7-29        | 6277   |
| 640            | 10          | 2019-7-2         | 2604   |
| 965            | 49          | 2019-7-6         | 1049   |
| 212            | 10          | 2019-7-29        | 5599   |
| 960            | 34          | 2019-7-19        | 7842   |
| 796            | 30          | 2019-7-13        | 7027   |
| 233            | 32          | 2019-7-4         | 1454   |
| 560            | 6           | 2019-8-19        | 6576   |
| 545            | 10          | 2019-8-21        | 9398   |
| 8              | 26          | 2019-7-12        | 8686   |
| 479            | 30          | 2019-7-6         | 7341   |
| 591            | 50          | 2019-7-28        | 9701   |
| 985            | 1           | 2019-8-16        | 844    |
| 349            | 10          | 2019-7-11        | 7814   |
| 424            | 35          | 2019-8-9         | 8172   |
| 192            | 37          | 2019-7-14        | 6262   |
| 224            | 50          | 2019-7-24        | 693    |
| 443            | 12          | 2019-8-5         | 476    |
| 653            | 4           | 2019-8-10        | 2308   |
| 309            | 49          | 2019-8-26        | 627    |
| 558            | 35          | 2019-8-18        | 7287   |
| 909            | 18          | 2019-7-28        | 8449   |
| 862            | 18          | 2019-8-7         | 5711   |
| 597            | 46          | 2019-7-16        | 9703   |
| 617            | 42          | 2019-7-19        | 7215   |
| 894            | 15          | 2019-7-3         | 3583   |
| 709            | 5           | 2019-7-12        | 2431   |
| 966            | 2           | 2019-7-16        | 3584   |
| 840            | 32          | 2019-8-6         | 4919   |
| 160            | 6           | 2019-7-23        | 210    |
| 868            | 32          | 2019-8-1         | 5173   |
| 211            | 42          | 2019-7-27        | 4836   |
| 823            | 33          | 2019-7-1         | 742    |
| 759            | 46          | 2019-7-22        | 8358   |
| 413            | 50          | 2019-7-13        | 9124   |
| 164            | 50          | 2019-7-23        | 477    |
| 134            | 24          | 2019-8-30        | 730    |
| 882            | 25          | 2019-8-14        | 962    |
| 87             | 28          | 2019-7-27        | 7902   |

--output:

| customer_id | consecutive_start | consecutive_end |
| ----------- | ----------------- | --------------- |
| 15          | 2019-07-24        | 2019-07-26      |
| 24          | 2019-07-15        | 2019-07-17      |
| 35          | 2019-08-17        | 2019-08-19      |
| 37          | 2019-08-03        | 2019-08-05      |
| 43          | 2019-07-03        | 2019-07-05      |
| 43          | 2019-08-13        | 2019-08-15      |

-- test case 2 --- end

-- test case 3 --- begin

| transaction_id | customer_id | transaction_date | amount |
| -------------- | ----------- | ---------------- | ------ |
| 653            | 4           | 2019-8-9         | 5800   |
| 856            | 15          | 2019-7-26        | 1044   |
| 181            | 9           | 2019-7-25        | 1673   |
| 923            | 43          | 2019-7-21        | 2238   |
| 916            | 34          | 2019-7-22        | 2936   |
| 907            | 8           | 2019-8-29        | 5936   |
| 25             | 35          | 2019-7-17        | 8273   |
| 783            | 37          | 2019-7-3         | 4070   |
| 65             | 22          | 2019-7-10        | 7819   |
| 983            | 19          | 2019-8-16        | 6505   |
| 60             | 4           | 2019-7-3         | 2161   |
| 832            | 34          | 2019-8-15        | 2442   |
| 779            | 44          | 2019-7-22        | 7188   |
| 643            | 7           | 2019-8-29        | 1229   |
| 490            | 7           | 2019-7-12        | 3345   |
| 434            | 3           | 2019-8-12        | 7765   |
| 477            | 19          | 2019-8-13        | 4440   |
| 657            | 7           | 2019-8-2         | 506    |
| 227            | 29          | 2019-7-2         | 4900   |
| 786            | 34          | 2019-8-21        | 6234   |
| 542            | 34          | 2019-7-16        | 8052   |
| 835            | 20          | 2019-8-15        | 3576   |
| 937            | 37          | 2019-8-12        | 2810   |
| 843            | 27          | 2019-8-17        | 9774   |
| 221            | 44          | 2019-7-16        | 6894   |
| 720            | 15          | 2019-8-10        | 1855   |
| 175            | 19          | 2019-8-4         | 7312   |
| 519            | 22          | 2019-7-3         | 3550   |
| 51             | 19          | 2019-8-30        | 7440   |
| 400            | 4           | 2019-7-17        | 7929   |
| 845            | 15          | 2019-7-14        | 7029   |
| 41             | 17          | 2019-7-11        | 349    |
| 231            | 15          | 2019-8-29        | 2072   |
| 297            | 35          | 2019-8-4         | 2352   |
| 563            | 22          | 2019-7-29        | 1624   |
| 695            | 34          | 2019-7-3         | 7407   |
| 64             | 8           | 2019-8-11        | 2803   |
| 71             | 17          | 2019-8-8         | 3432   |
| 763            | 34          | 2019-7-6         | 9112   |
| 276            | 8           | 2019-8-3         | 7948   |
| 708            | 34          | 2019-7-28        | 4978   |
| 622            | 43          | 2019-7-24        | 7446   |
| 327            | 45          | 2019-8-2         | 6227   |
| 151            | 29          | 2019-7-19        | 9442   |
| 631            | 19          | 2019-8-23        | 1776   |
| 800            | 37          | 2019-8-18        | 1280   |
| 301            | 1           | 2019-7-10        | 8407   |
| 965            | 7           | 2019-7-8         | 726    |
| 352            | 29          | 2019-8-20        | 8432   |
| 145            | 4           | 2019-7-9         | 8934   |
| 894            | 43          | 2019-7-2         | 1607   |
| 974            | 15          | 2019-7-18        | 6177   |
| 729            | 18          | 2019-8-15        | 7415   |
| 324            | 29          | 2019-7-24        | 1160   |
| 981            | 3           | 2019-8-9         | 118    |
| 78             | 37          | 2019-7-22        | 1187   |
| 120            | 3           | 2019-7-24        | 5935   |
| 8              | 31          | 2019-8-2         | 6654   |
| 235            | 9           | 2019-7-9         | 2682   |
| 160            | 4           | 2019-7-5         | 7287   |
| 89             | 7           | 2019-8-15        | 5868   |
| 185            | 37          | 2019-7-6         | 9731   |
| 236            | 29          | 2019-7-25        | 4982   |
| 598            | 33          | 2019-8-16        | 4035   |
| 514            | 1           | 2019-8-10        | 5263   |
| 501            | 7           | 2019-8-1         | 5025   |
| 560            | 44          | 2019-8-13        | 6592   |
| 768            | 20          | 2019-8-29        | 9933   |
| 264            | 35          | 2019-7-20        | 1710   |
| 562            | 15          | 2019-7-15        | 4345   |
| 241            | 37          | 2019-8-30        | 3850   |
| 588            | 37          | 2019-8-14        | 742    |
| 359            | 35          | 2019-8-18        | 9792   |
| 419            | 37          | 2019-8-28        | 1522   |
| 178            | 19          | 2019-7-20        | 2945   |
| 941            | 31          | 2019-7-30        | 3972   |
| 592            | 17          | 2019-7-4         | 3786   |
| 82             | 1           | 2019-7-18        | 7115   |
| 154            | 15          | 2019-7-24        | 4352   |
| 707            | 44          | 2019-8-8         | 6944   |
| 609            | 29          | 2019-8-9         | 1085   |
| 818            | 43          | 2019-7-10        | 3926   |
| 759            | 18          | 2019-7-20        | 4810   |
| 526            | 44          | 2019-8-25        | 6739   |
| 674            | 43          | 2019-8-23        | 9405   |
| 97             | 20          | 2019-8-9         | 2996   |
| 278            | 9           | 2019-8-15        | 6766   |
| 503            | 37          | 2019-7-18        | 3073   |
| 265            | 33          | 2019-7-24        | 9400   |
| 55             | 31          | 2019-8-21        | 374    |
| 577            | 34          | 2019-8-7         | 4830   |
| 601            | 27          | 2019-8-30        | 9444   |
| 101            | 9           | 2019-7-15        | 1198   |
| 468            | 17          | 2019-7-23        | 5304   |
| 875            | 43          | 2019-8-20        | 4347   |
| 397            | 15          | 2019-7-8         | 1729   |
| 176            | 22          | 2019-7-22        | 1270   |
| 947            | 9           | 2019-7-28        | 4647   |
| 180            | 17          | 2019-7-12        | 5437   |
| 266            | 17          | 2019-7-28        | 9245   |
| 43             | 27          | 2019-7-27        | 9254   |
| 878            | 8           | 2019-8-9         | 1844   |
| 605            | 8           | 2019-8-27        | 8823   |
| 772            | 4           | 2019-8-6         | 7087   |
| 705            | 1           | 2019-8-6         | 4513   |
| 37             | 1           | 2019-7-6         | 9149   |
| 972            | 4           | 2019-8-17        | 3327   |
| 757            | 3           | 2019-7-2         | 9959   |
| 805            | 43          | 2019-7-6         | 554    |
| 315            | 8           | 2019-8-6         | 1464   |
| 137            | 22          | 2019-8-30        | 2784   |
| 873            | 19          | 2019-8-25        | 8697   |
| 10             | 1           | 2019-8-20        | 7267   |
| 365            | 19          | 2019-7-31        | 9856   |
| 469            | 22          | 2019-7-2         | 784    |
| 508            | 22          | 2019-8-23        | 6879   |
| 311            | 20          | 2019-8-3         | 7581   |
| 961            | 3           | 2019-7-8         | 107    |
| 956            | 33          | 2019-7-21        | 4331   |
| 230            | 3           | 2019-8-15        | 3315   |
| 629            | 7           | 2019-7-4         | 6444   |
| 190            | 22          | 2019-8-27        | 5628   |
| 257            | 45          | 2019-7-28        | 7522   |
| 964            | 31          | 2019-8-22        | 6527   |
| 692            | 18          | 2019-8-11        | 8244   |
| 244            | 44          | 2019-7-12        | 2105   |
| 825            | 19          | 2019-7-6         | 2235   |
| 432            | 4           | 2019-8-28        | 7039   |
| 986            | 7           | 2019-8-6         | 626    |
| 696            | 34          | 2019-7-23        | 6137   |
| 735            | 15          | 2019-7-13        | 3744   |
| 840            | 35          | 2019-8-1         | 5383   |
| 357            | 1           | 2019-7-7         | 7072   |
| 435            | 1           | 2019-8-31        | 6198   |
| 360            | 22          | 2019-7-30        | 1600   |
| 816            | 20          | 2019-7-26        | 1193   |
| 967            | 8           | 2019-8-23        | 4070   |
| 621            | 31          | 2019-7-16        | 9495   |
| 277            | 35          | 2019-8-24        | 3918   |
| 198            | 44          | 2019-7-20        | 4094   |
| 237            | 19          | 2019-7-10        | 5418   |
| 821            | 1           | 2019-8-29        | 4339   |
| 507            | 45          | 2019-8-8         | 433    |
| 992            | 7           | 2019-8-18        | 6695   |
| 658            | 22          | 2019-7-26        | 2894   |
| 81             | 43          | 2019-7-23        | 430    |
| 704            | 29          | 2019-7-30        | 4364   |
| 354            | 22          | 2019-8-12        | 3505   |
| 690            | 22          | 2019-8-17        | 4691   |
| 659            | 19          | 2019-8-29        | 3680   |
| 392            | 27          | 2019-8-1         | 5119   |
| 661            | 27          | 2019-8-10        | 8997   |
| 580            | 8           | 2019-7-26        | 9137   |
| 168            | 7           | 2019-8-30        | 798    |
| 374            | 35          | 2019-7-5         | 1218   |
| 375            | 34          | 2019-8-1         | 5666   |
| 842            | 4           | 2019-7-19        | 6812   |
| 395            | 44          | 2019-8-17        | 9963   |
| 387            | 20          | 2019-7-1         | 3624   |
| 454            | 7           | 2019-7-9         | 9264   |
| 222            | 31          | 2019-7-15        | 8363   |
| 391            | 37          | 2019-8-1         | 1841   |
| 418            | 44          | 2019-8-12        | 3350   |
| 702            | 20          | 2019-7-23        | 2438   |
| 900            | 17          | 2019-8-11        | 4140   |
| 943            | 31          | 2019-8-11        | 3253   |
| 927            | 34          | 2019-8-20        | 9711   |
| 340            | 18          | 2019-7-16        | 2885   |
| 54             | 15          | 2019-7-1         | 5774   |
| 148            | 1           | 2019-7-8         | 2236   |
| 803            | 15          | 2019-8-9         | 9541   |
| 83             | 17          | 2019-8-7         | 172    |
| 694            | 44          | 2019-7-8         | 4607   |
| 713            | 1           | 2019-7-23        | 4336   |
| 2              | 15          | 2019-8-4         | 3705   |
| 770            | 27          | 2019-8-24        | 1952   |
| 112            | 17          | 2019-7-1         | 3104   |
| 445            | 4           | 2019-7-16        | 4495   |
| 671            | 9           | 2019-7-21        | 1824   |
| 460            | 3           | 2019-7-6         | 1612   |
| 463            | 43          | 2019-8-21        | 2811   |
| 591            | 22          | 2019-8-9         | 4864   |
| 187            | 31          | 2019-7-23        | 2678   |
| 688            | 45          | 2019-7-1         | 2991   |
| 973            | 27          | 2019-7-10        | 6268   |
| 305            | 27          | 2019-8-23        | 8009   |
| 822            | 4           | 2019-8-24        | 725    |
| 238            | 22          | 2019-8-2         | 7295   |
| 747            | 1           | 2019-7-3         | 9621   |
| 888            | 43          | 2019-7-25        | 2209   |
| 361            | 8           | 2019-7-15        | 9534   |
| 245            | 8           | 2019-7-24        | 6985   |
| 904            | 17          | 2019-7-5         | 3095   |
| 448            | 35          | 2019-8-16        | 4653   |
| 210            | 33          | 2019-8-15        | 1652   |
| 844            | 3           | 2019-7-17        | 8024   |
| 871            | 29          | 2019-7-29        | 8237   |
| 594            | 45          | 2019-8-9         | 7790   |
| 286            | 19          | 2019-8-8         | 6886   |
| 655            | 1           | 2019-7-24        | 9089   |
| 545            | 8           | 2019-8-4         | 8430   |
| 620            | 1           | 2019-7-1         | 2732   |
| 698            | 1           | 2019-8-27        | 5292   |
| 689            | 45          | 2019-7-22        | 4015   |
| 533            | 9           | 2019-8-20        | 534    |
| 142            | 33          | 2019-7-9         | 6326   |
| 456            | 20          | 2019-8-21        | 6482   |
| 5              | 20          | 2019-8-1         | 7537   |
| 96             | 18          | 2019-8-13        | 8503   |
| 997            | 45          | 2019-8-22        | 3554   |
| 733            | 8           | 2019-8-15        | 2564   |
| 232            | 20          | 2019-7-28        | 8202   |
| 109            | 33          | 2019-8-19        | 1667   |
| 129            | 15          | 2019-8-3         | 6599   |
| 656            | 4           | 2019-8-27        | 9329   |
| 633            | 34          | 2019-7-12        | 360    |
| 425            | 34          | 2019-7-11        | 1208   |
| 179            | 4           | 2019-8-21        | 1136   |
| 969            | 4           | 2019-8-3         | 9213   |
| 110            | 4           | 2019-8-14        | 311    |
| 691            | 19          | 2019-7-14        | 5664   |
| 382            | 8           | 2019-7-22        | 142    |
| 72             | 22          | 2019-7-18        | 6001   |
| 869            | 45          | 2019-7-25        | 3063   |
| 645            | 1           | 2019-8-18        | 1038   |
| 128            | 33          | 2019-8-2         | 4739   |
| 529            | 4           | 2019-7-4         | 1799   |
| 50             | 9           | 2019-7-4         | 9523   |
| 511            | 33          | 2019-8-13        | 2908   |
| 625            | 15          | 2019-7-23        | 1708   |
| 269            | 43          | 2019-7-18        | 3421   |
| 522            | 9           | 2019-8-1         | 7020   |
| 886            | 19          | 2019-7-22        | 2699   |
| 213            | 29          | 2019-7-15        | 7001   |
| 280            | 8           | 2019-7-10        | 4679   |
| 233            | 35          | 2019-8-13        | 1661   |
| 918            | 44          | 2019-8-3         | 5187   |
| 585            | 20          | 2019-8-13        | 8145   |
| 26             | 27          | 2019-8-21        | 359    |
| 256            | 1           | 2019-8-23        | 2754   |
| 793            | 9           | 2019-8-7         | 9107   |
| 132            | 19          | 2019-7-15        | 642    |
| 953            | 18          | 2019-8-4         | 617    |
| 935            | 22          | 2019-8-8         | 4072   |
| 517            | 20          | 2019-7-8         | 988    |
| 740            | 35          | 2019-8-26        | 9849   |
| 383            | 19          | 2019-8-14        | 884    |
| 703            | 9           | 2019-8-29        | 1696   |
| 799            | 4           | 2019-8-11        | 4941   |
| 443            | 33          | 2019-8-22        | 4105   |
| 215            | 7           | 2019-8-20        | 7035   |
| 52             | 27          | 2019-7-3         | 4246   |
| 193            | 43          | 2019-7-19        | 3680   |
| 833            | 45          | 2019-8-24        | 7050   |
| 870            | 1           | 2019-8-9         | 5928   |
| 85             | 3           | 2019-7-29        | 6681   |
| 351            | 9           | 2019-7-26        | 305    |
| 959            | 20          | 2019-7-9         | 1827   |
| 369            | 4           | 2019-8-12        | 3776   |
| 535            | 19          | 2019-8-21        | 5437   |
| 38             | 22          | 2019-7-12        | 240    |
| 207            | 4           | 2019-7-18        | 7607   |
| 647            | 45          | 2019-8-17        | 565    |
| 289            | 27          | 2019-8-4         | 9384   |
| 332            | 20          | 2019-7-5         | 3505   |
| 267            | 34          | 2019-8-31        | 7407   |
| 765            | 8           | 2019-8-5         | 6547   |
| 46             | 37          | 2019-7-23        | 5087   |
| 891            | 1           | 2019-7-30        | 8957   |
| 550            | 20          | 2019-7-20        | 6511   |
| 497            | 35          | 2019-7-19        | 825    |
| 246            | 44          | 2019-8-1         | 2830   |
| 131            | 22          | 2019-7-17        | 8152   |
| 159            | 1           | 2019-8-2         | 980    |
| 636            | 45          | 2019-7-9         | 7631   |
| 782            | 1           | 2019-7-15        | 3883   |
| 673            | 7           | 2019-7-10        | 7191   |
| 666            | 34          | 2019-7-9         | 2468   |
| 214            | 18          | 2019-8-12        | 5205   |
| 1              | 44          | 2019-7-17        | 2201   |
| 122            | 15          | 2019-7-2         | 8066   |
| 836            | 45          | 2019-7-13        | 5862   |
| 619            | 45          | 2019-8-31        | 4693   |
| 499            | 34          | 2019-8-12        | 5746   |
| 261            | 35          | 2019-7-21        | 4978   |
| 509            | 15          | 2019-8-30        | 4383   |
| 925            | 22          | 2019-7-25        | 6864   |
| 182            | 17          | 2019-8-24        | 1623   |
| 247            | 33          | 2019-8-5         | 3823   |
| 993            | 9           | 2019-7-31        | 615    |
| 536            | 43          | 2019-7-27        | 5592   |
| 809            | 3           | 2019-7-15        | 6792   |
| 197            | 9           | 2019-7-8         | 1143   |
| 188            | 29          | 2019-8-14        | 3073   |
| 437            | 29          | 2019-7-23        | 754    |
| 216            | 8           | 2019-7-25        | 3149   |
| 452            | 43          | 2019-7-12        | 4495   |
| 202            | 19          | 2019-8-1         | 496    |
| 962            | 44          | 2019-8-21        | 2088   |
| 957            | 44          | 2019-7-7         | 9917   |
| 139            | 18          | 2019-8-28        | 4699   |
| 376            | 9           | 2019-8-27        | 9319   |
| 174            | 20          | 2019-7-2         | 9755   |
| 115            | 1           | 2019-7-14        | 7545   |
| 634            | 31          | 2019-7-7         | 3290   |
| 849            | 29          | 2019-7-28        | 2948   |
| 771            | 3           | 2019-8-26        | 5247   |
| 865            | 22          | 2019-8-13        | 1776   |
| 697            | 4           | 2019-7-12        | 6758   |
| 125            | 37          | 2019-7-17        | 4349   |
| 924            | 15          | 2019-8-22        | 432    |
| 761            | 29          | 2019-7-31        | 6176   |
| 573            | 1           | 2019-8-4         | 9564   |
| 254            | 1           | 2019-7-25        | 7764   |
| 156            | 45          | 2019-8-10        | 9051   |
| 614            | 7           | 2019-8-31        | 1230   |
| 388            | 20          | 2019-7-3         | 8374   |
| 954            | 18          | 2019-8-2         | 7391   |
| 121            | 4           | 2019-7-26        | 1210   |
| 49             | 37          | 2019-7-30        | 7033   |
| 66             | 33          | 2019-7-5         | 908    |
| 525            | 44          | 2019-8-9         | 4087   |
| 813            | 9           | 2019-8-4         | 1953   |
| 423            | 1           | 2019-7-12        | 4610   |
| 911            | 18          | 2019-7-8         | 276    |
| 646            | 37          | 2019-7-31        | 5964   |
| 310            | 1           | 2019-8-15        | 646    |
| 868            | 43          | 2019-7-22        | 742    |
| 439            | 37          | 2019-7-9         | 3393   |
| 287            | 22          | 2019-7-11        | 3646   |
| 347            | 3           | 2019-8-21        | 8229   |
| 344            | 27          | 2019-8-14        | 1553   |
| 781            | 18          | 2019-8-22        | 9168   |
| 933            | 27          | 2019-7-30        | 6213   |
| 716            | 27          | 2019-8-27        | 8804   |
| 528            | 44          | 2019-8-20        | 606    |
| 660            | 31          | 2019-7-10        | 9324   |
| 797            | 34          | 2019-8-8         | 2192   |
| 57             | 33          | 2019-7-14        | 2161   |
| 895            | 19          | 2019-7-3         | 8736   |
| 641            | 7           | 2019-8-8         | 4753   |
| 377            | 4           | 2019-7-10        | 4887   |
| 493            | 31          | 2019-7-29        | 6877   |
| 223            | 3           | 2019-8-19        | 3600   |
| 263            | 7           | 2019-7-3         | 5261   |
| 760            | 8           | 2019-7-5         | 3255   |
| 258            | 27          | 2019-7-11        | 9880   |
| 229            | 33          | 2019-7-18        | 6360   |
| 45             | 1           | 2019-7-19        | 8309   |
| 296            | 19          | 2019-8-9         | 1347   |
| 358            | 15          | 2019-8-20        | 9238   |
| 714            | 18          | 2019-8-14        | 460    |
| 135            | 29          | 2019-8-31        | 924    |
| 313            | 27          | 2019-7-29        | 7849   |
| 338            | 35          | 2019-7-26        | 3444   |
| 219            | 20          | 2019-7-14        | 7257   |
| 857            | 35          | 2019-8-11        | 4314   |
| 677            | 19          | 2019-7-4         | 5694   |
| 399            | 18          | 2019-7-2         | 1425   |
| 430            | 7           | 2019-7-6         | 9446   |
| 133            | 1           | 2019-7-13        | 4918   |
| 946            | 1           | 2019-8-30        | 5655   |
| 29             | 44          | 2019-7-25        | 8013   |
| 192            | 27          | 2019-7-28        | 7565   |
| 243            | 34          | 2019-7-15        | 1895   |
| 808            | 15          | 2019-7-5         | 6752   |
| 31             | 9           | 2019-7-22        | 3000   |
| 864            | 27          | 2019-8-13        | 7900   |
| 325            | 37          | 2019-7-15        | 4006   |
| 558            | 20          | 2019-7-10        | 716    |
| 431            | 31          | 2019-8-5         | 7931   |
| 429            | 44          | 2019-8-15        | 6529   |
| 909            | 27          | 2019-7-17        | 2402   |
| 348            | 15          | 2019-8-12        | 5336   |
| 3              | 33          | 2019-8-11        | 2481   |
| 745            | 3           | 2019-7-30        | 8780   |
| 566            | 9           | 2019-7-20        | 217    |
| 572            | 17          | 2019-8-1         | 2838   |

--output:

| customer_id | consecutive_start | consecutive_end |
| ----------- | ----------------- | --------------- |
| 1           | 2019-07-12        | 2019-07-14      |
| 1           | 2019-08-29        | 2019-08-31      |
| 9           | 2019-07-20        | 2019-07-22      |
| 29          | 2019-07-23        | 2019-07-25      |
| 35          | 2019-07-19        | 2019-07-21      |
| 45          | 2019-08-08        | 2019-08-10      |

-- test case 3 --- end

-- test case 4 --- begin

| transaction_id | customer_id | transaction_date | amount |
| -------------- | ----------- | ---------------- | ------ |
| 66             | 25          | 2019-8-26        | 5873   |
| 28             | 12          | 2019-8-28        | 6848   |
| 31             | 11          | 2019-7-8         | 863    |
| 702            | 20          | 2019-8-25        | 6360   |
| 281            | 10          | 2019-7-6         | 3147   |
| 553            | 41          | 2019-7-5         | 1883   |
| 309            | 12          | 2019-8-8         | 1056   |
| 508            | 9           | 2019-7-4         | 9986   |
| 517            | 26          | 2019-8-21        | 2574   |
| 451            | 23          | 2019-7-10        | 3319   |
| 917            | 10          | 2019-7-13        | 7322   |
| 177            | 25          | 2019-7-23        | 4694   |
| 991            | 3           | 2019-8-2         | 1628   |
| 389            | 1           | 2019-7-2         | 4423   |
| 772            | 28          | 2019-8-10        | 5313   |
| 53             | 14          | 2019-7-24        | 1751   |
| 199            | 44          | 2019-7-27        | 8942   |
| 860            | 3           | 2019-8-31        | 5984   |
| 442            | 10          | 2019-7-18        | 3888   |
| 741            | 12          | 2019-8-1         | 9040   |
| 995            | 5           | 2019-8-7         | 5357   |
| 583            | 25          | 2019-7-5         | 3324   |
| 938            | 15          | 2019-8-30        | 1551   |
| 613            | 9           | 2019-7-24        | 8407   |
| 154            | 5           | 2019-7-27        | 1907   |
| 548            | 26          | 2019-8-14        | 9688   |
| 667            | 23          | 2019-7-29        | 1496   |
| 518            | 2           | 2019-7-22        | 2229   |
| 455            | 32          | 2019-8-30        | 471    |
| 337            | 12          | 2019-7-19        | 8865   |
| 963            | 25          | 2019-8-18        | 383    |
| 850            | 14          | 2019-7-31        | 1011   |
| 513            | 19          | 2019-7-10        | 5266   |
| 228            | 9           | 2019-7-27        | 4900   |
| 287            | 32          | 2019-8-31        | 7132   |
| 134            | 32          | 2019-8-16        | 376    |
| 148            | 13          | 2019-7-15        | 4587   |
| 57             | 10          | 2019-8-12        | 5173   |
| 560            | 18          | 2019-8-28        | 6441   |
| 427            | 10          | 2019-8-2         | 2340   |
| 878            | 9           | 2019-7-11        | 267    |
| 85             | 44          | 2019-8-2         | 5785   |
| 614            | 45          | 2019-8-17        | 2136   |
| 261            | 45          | 2019-7-12        | 4036   |
| 472            | 23          | 2019-8-7         | 8744   |
| 446            | 12          | 2019-7-13        | 8232   |
| 806            | 3           | 2019-8-3         | 9599   |
| 526            | 25          | 2019-8-16        | 2692   |
| 615            | 32          | 2019-8-2         | 2465   |
| 231            | 19          | 2019-7-22        | 8672   |
| 716            | 5           | 2019-7-29        | 6205   |
| 466            | 1           | 2019-7-6         | 8692   |
| 992            | 15          | 2019-7-31        | 9633   |
| 654            | 25          | 2019-7-14        | 9050   |
| 305            | 23          | 2019-7-1         | 4946   |
| 44             | 9           | 2019-7-26        | 1850   |
| 126            | 25          | 2019-8-1         | 7314   |
| 529            | 28          | 2019-8-27        | 1513   |
| 554            | 26          | 2019-7-2         | 410    |
| 465            | 11          | 2019-8-31        | 4958   |
| 459            | 41          | 2019-8-15        | 1260   |
| 338            | 10          | 2019-7-8         | 5801   |
| 902            | 19          | 2019-7-28        | 3215   |
| 527            | 13          | 2019-8-11        | 6907   |
| 91             | 19          | 2019-8-13        | 2367   |
| 651            | 44          | 2019-8-26        | 7551   |
| 599            | 19          | 2019-8-18        | 9754   |
| 107            | 32          | 2019-8-15        | 9571   |
| 555            | 2           | 2019-8-15        | 6279   |
| 489            | 2           | 2019-8-31        | 2232   |
| 81             | 5           | 2019-7-1         | 5730   |
| 880            | 32          | 2019-8-29        | 1679   |
| 574            | 28          | 2019-8-15        | 6526   |
| 796            | 23          | 2019-8-10        | 4688   |
| 204            | 23          | 2019-7-6         | 2134   |
| 272            | 10          | 2019-7-9         | 4233   |
| 682            | 20          | 2019-8-7         | 4250   |
| 500            | 14          | 2019-7-30        | 7792   |
| 22             | 18          | 2019-7-25        | 8341   |
| 635            | 11          | 2019-8-14        | 3556   |
| 260            | 23          | 2019-8-5         | 7334   |
| 754            | 12          | 2019-8-18        | 2852   |
| 487            | 9           | 2019-7-20        | 6806   |
| 294            | 19          | 2019-7-15        | 5835   |
| 536            | 5           | 2019-8-8         | 8570   |
| 349            | 13          | 2019-8-17        | 4288   |
| 632            | 11          | 2019-8-21        | 1632   |
| 173            | 14          | 2019-8-20        | 8876   |
| 630            | 15          | 2019-7-23        | 2027   |
| 288            | 23          | 2019-8-29        | 2876   |
| 914            | 41          | 2019-8-30        | 2933   |
| 966            | 15          | 2019-8-26        | 7863   |
| 202            | 41          | 2019-7-28        | 6272   |
| 368            | 14          | 2019-8-27        | 403    |
| 151            | 20          | 2019-7-9         | 329    |
| 84             | 19          | 2019-8-5         | 332    |
| 814            | 45          | 2019-8-7         | 2270   |
| 364            | 1           | 2019-7-3         | 4586   |
| 711            | 11          | 2019-7-19        | 1402   |
| 981            | 46          | 2019-8-13        | 6942   |
| 394            | 23          | 2019-8-14        | 5850   |
| 495            | 20          | 2019-7-4         | 6251   |
| 373            | 23          | 2019-8-31        | 5786   |
| 20             | 1           | 2019-7-15        | 9693   |
| 582            | 15          | 2019-7-5         | 2727   |
| 779            | 44          | 2019-7-12        | 703    |

--output:

| customer_id | consecutive_start | consecutive_end |
| ----------- | ----------------- | --------------- |

-- test case 4 --- end

--solution 1:


WITH CTE AS(
SELECT
	customer_id,
    transaction_date,
    LEAD(amount) OVER(PARTITION BY customer_id ORDER BY transaction_date) lead_amount,
    LEAD(transaction_date) OVER(PARTITION BY customer_id ORDER BY transaction_date) lead_transaction_date,
    CASE WHEN amount < LEAD(amount) OVER(PARTITION BY customer_id ORDER BY transaction_date)
	AND DATEDIFF(DAY,transaction_date,LEAD(transaction_date) OVER(PARTITION BY customer_id ORDER BY transaction_date)) = 1
    THEN 1 ELSE NULL END check_amount_trandate
FROM
	Transactions
),CTE2 AS(
SELECT *, ROW_NUMBER() OVER(ORDER BY (SELECT NULL)) keyid
FROM (SELECT 9999999999 customer_id, 0 lead_amount,  '1900-01-01' transaction_date, '1900-01-01' lead_transaction_date, null check_amount_trandate
	UNION ALL
	SELECT customer_id, lead_amount,transaction_date, lead_transaction_date, check_amount_trandate FROM CTE
	UNION ALL
	SELECT 9999999999 customer_id, 0 lead_amount, '2500-01-01' transaction_date, '2500-01-01' lead_transaction_date, null check_amount_trandate)sub
) 
,CTE3 AS(
SELECT
	customer_id,
    transaction_date,
    lead_transaction_date,
    keyid,
    LEAD(keyid) OVER(ORDER BY (SELECT NULL)) next_keyid,
    LEAD(keyid) OVER(ORDER BY (SELECT NULL)) - keyid diff,
	ROW_NUMBER() OVER(ORDER BY (SELECT NULL)) keyid_gb
FROM	
	CTE2
WHERE
	check_amount_trandate IS NULL
) 
,CTE4 AS(
	SELECT
		sub.customer_id,
		sub.transaction_date,
		sub.lead_transaction_date,
		c.diff,
		C.keyid_gb
	FROM
		CTE3 C
	OUTER APPLY(
		SELECT * FROM CTE2 C1 WHERE C1.keyid BETWEEN C.keyid + 1 AND C.next_keyid - 1
	)sub
	WHERE
		check_amount_trandate is not null AND sub.lead_transaction_date IS NOT NULL AND sub.customer_id <> 9999999999 
	AND diff - 1 > 1
)
SELECT
	customer_id,
	MIN(transaction_date) consecutive_start,
	MAX(lead_transaction_date) consecutive_end
FROM
	CTE4
GROUP BY customer_id, keyid_gb
ORDER BY customer_id

--solution 2:

-- sub table CTE: find next day, next amount
	
WITH CTE AS(
	SELECT 
		customer_id, transaction_date, amount, 
		LEAD(amount) OVER(PARTITION BY customer_id ORDER BY transaction_date) lead_amount,
		LEAD(transaction_date) OVER(PARTITION BY customer_id ORDER BY transaction_date) lead_transaction_date
	FROM 
		Transactions	
)
-- sub table CTE2: check valid "day" and "amount": if "lead_day" substract "curr_day" = 1 AND "lead_amount" > "curr_amount" then 1 Else null.
,CTE2 AS(
	SELECT 
		customer_id, transaction_date, amount, lead_amount,
		CASE WHEN lead_amount > amount AND (lead_transaction_date -  transaction_date) = 1 THEN 1 ELSE NULL END check_valid_amount
	FROM 
		CTE
) 
-- sub table CTE3: mark row_number() for all rows.
-- transaction_date - key_gb => distinct value for each group
,CTE3 AS(
SELECT
	customer_id, transaction_date, amount, lead_amount,
	transaction_date - (key_gb || ' DAYS')::INTERVAL diff
FROM
	(SELECT 
		customer_id, transaction_date, amount, lead_amount,
		ROW_NUMBER() OVER(ORDER BY (SELECT NULL)) key_gb
	FROM
		CTE2
	WHERE 
		check_valid_amount IS NOT NULL) sub
	
)
-- sub table CTE4: get minimum date for each group
-- count the total number of elements for each group
,CTE4 AS(
	SELECT DISTINCT
		customer_id,
		MIN(transaction_date) OVER(PARTITION BY customer_id, diff) min_transaction_date,
		COUNT(1) OVER(PARTITION BY customer_id, diff) total_conse
	FROM
		CTE3
) 
-- final: Take only total_conse greater than 1
	SELECT 
		customer_id,
		min_transaction_date::DATE consecutive_start,
		(min_transaction_date  + ( total_conse || ' DAYS')::INTERVAL)::DATE  consecutive_end
	FROM
		CTE4
	WHERE
		total_conse > 1
	ORDER BY customer_id, consecutive_start
	
-- solution 3:

WITH CTE AS(
SELECT  
    *,
    ROW_NUMBER() OVER(ORDER BY (SELECT NULL)) key_gb
FROM    
    (
    SELECT
		T.customer_id,
		T.transaction_date
	FROM
		Transactions T
	INNER JOIN
		Transactions T1 ON T.customer_id = T1.customer_id 
		AND T1.amount > T.amount
		AND T1.transaction_date - T.transaction_date  =1
	ORDER BY T.customer_id,
		T.transaction_date
    )sub
	
)
,CTE2 AS(
	SELECT 
		customer_id,
		transaction_date, 
		transaction_date - (key_gb || ' days')::INTERVAL diff
	FROM 
		CTE
) --SELECT * FROM CTE2
SELECT 
	customer_id,
	MIN(transaction_date)::DATE consecutive_start,
	(MIN(transaction_date) + (COUNT(1) || ' days')::INTERVAL)::DATE  consecutive_end
FROM
	CTE2
GROUP BY 
	customer_id, diff
HAVING COUNT(1) > 1
ORDER BY 
	customer_id, consecutive_start

